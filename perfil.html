<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REPTECH - Meu Perfil</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <style>
        :root { --bg-color: #000000; --card-bg: #111111; --accent-blue: #007AFF; --input-bg: #1C1C1E; --text-white: #ffffff; }
        body { background-color: var(--bg-color); color: var(--text-white); font-family: -apple-system, sans-serif; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        h2 { margin-bottom: 30px; color: var(--accent-blue); }
        
        .profile-card { background-color: var(--card-bg); width: 100%; max-width: 400px; padding: 25px; border-radius: 20px; border: 1px solid #333; }
        
        label { display: block; color: #888; font-size: 12px; margin-bottom: 5px; margin-top: 15px; text-transform: uppercase; letter-spacing: 1px; }
        
        input { width: 100%; background-color: var(--input-bg); border: 1px solid #333; padding: 15px; border-radius: 10px; color: white; font-size: 16px; box-sizing: border-box; }
        input:focus { outline: none; border-color: var(--accent-blue); }

        .row { display: flex; gap: 10px; }
        .col { flex: 1; }

        .btn-save { width: 100%; padding: 15px; background: var(--accent-blue); border: none; border-radius: 10px; color: white; font-weight: bold; font-size: 16px; cursor: pointer; margin-top: 30px; }
        .btn-back { background: transparent; border: none; color: #666; margin-top: 15px; cursor: pointer; }
        
        .avatar-circle { width: 80px; height: 80px; background: #222; border-radius: 50%; margin: 0 auto 20px auto; display: flex; align-items: center; justify-content: center; font-size: 30px; border: 2px solid var(--accent-blue); }
    </style>
</head>
<body>

    <div class="profile-card">
        <div class="avatar-circle">ðŸ‘¤</div>
        <h2 style="text-align:center; margin-top:0;">Editar Perfil</h2>

        <label>Seu Nome (Como quer ser chamado)</label>
        <input type="text" id="input-name" placeholder="Ex: Hiro Tomito">

        <div class="row">
            <div class="col">
                <label>Idade</label>
                <input type="number" id="input-age" placeholder="Anos">
            </div>
            <div class="col">
                <label>Peso (kg)</label>
                <input type="number" id="input-weight" placeholder="Kg">
            </div>
        </div>
        
        <label>Altura (cm)</label>
        <input type="number" id="input-height" placeholder="Ex: 175">

        <button class="btn-save" onclick="saveProfile()">SALVAR DADOS</button>
        <button class="btn-back" onclick="window.location.href='dashboard.html'">Voltar</button>
    </div>

    <script>
        // --- COLE SUA API KEY AQUI IGUAL NOS OUTROS ARQUIVOS ---
        const firebaseConfig = {
            apiKey: "AIzaSyDo2Vhtj4aldfEr6CHoXVWP4fhhC1GZZIo", // <--- VERIFIQUE SE Ã‰ A SUA
            authDomain: "reptech-mvp.firebaseapp.com",
            databaseURL: "https://reptech-mvp-default-rtdb.firebaseio.com",
            projectId: "reptech-mvp",
            storageBucket: "reptech-mvp.firebasestorage.app",
            messagingSenderId: "350784354776",
            appId: "1:350784354776:web:6d7c99682b8e0980ec1aad"
        };
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();

        let currentUser = null;

        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                loadProfile();
            } else {
                window.location.href = "index.html";
            }
        });

        function loadProfile() {
            // Busca dados se jÃ¡ existirem
            db.ref('usuarios/' + currentUser.uid + '/perfil').once('value').then(snapshot => {
                const data = snapshot.val();
                if (data) {
                    if(data.nome) document.getElementById('input-name').value = data.nome;
                    if(data.idade) document.getElementById('input-age').value = data.idade;
                    if(data.peso) document.getElementById('input-weight').value = data.peso;
                    if(data.altura) document.getElementById('input-height').value = data.altura;
                }
            });
        }

        function saveProfile() {
            const nome = document.getElementById('input-name').value;
            const idade = document.getElementById('input-age').value;
            const peso = document.getElementById('input-weight').value;
            const altura = document.getElementById('input-height').value;

            if(!nome) return alert("Por favor, digite pelo menos seu nome.");

            db.ref('usuarios/' + currentUser.uid + '/perfil').set({
                nome: nome,
                idade: idade,
                peso: peso,
                altura: altura
            }).then(() => {
                alert("Perfil atualizado com sucesso!");
                window.location.href = "dashboard.html";
            }).catch(err => {
                alert("Erro ao salvar: " + err.message);
            });
        }
    </script>
</body>
</html>